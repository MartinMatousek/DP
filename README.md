<b>ČESKÁ VERZE V [README_CZ.md](https://github.com/MartinMatousek/DP/blob/main/README_CZ.md)</b>
# Audio samples of speech separation results

<details> 
	<summary><b> Model with corpus ee - clean</b></summary>

<details>
  <summary>ENG + ENG</summary>


https://user-images.githubusercontent.com/28596569/236252891-6e6d3c8e-df88-4df7-8415-6ee2848fc0a1.mp4


https://user-images.githubusercontent.com/28596569/236252901-fee3a8c8-218e-44ab-be95-3656bfa3fc5e.mp4


https://user-images.githubusercontent.com/28596569/236252906-2f38245d-b9ad-408a-9b59-de07328ec994.mp4

</details>
<details>
  <summary>ENG + TAI</summary>


https://user-images.githubusercontent.com/28596569/236252788-151db101-5112-4ee8-876f-3d3da93437ae.mp4


https://user-images.githubusercontent.com/28596569/236252797-81629d39-4d34-4087-8c6e-5d77ef1e75c2.mp4


https://user-images.githubusercontent.com/28596569/236252800-a23e1347-b65e-4aa2-9261-9a56ab24df82.mp4

</details>
<details>
  <summary>TAI + TAI</summary>


https://user-images.githubusercontent.com/28596569/236253012-bc2c0d37-87b2-496b-838d-b6d2bc49dcfe.mp4


https://user-images.githubusercontent.com/28596569/236253018-12e0e4fa-dd8c-4aaf-bca9-cee14fb346cb.mp4


https://user-images.githubusercontent.com/28596569/236253021-f2897fbc-4980-417f-ac97-896e7dd4fec4.mp4

</details>
</details>

<details> 
	<summary><b> Model with corpus et - clean</b></summary>
<details>
  <summary>ENG + ENG</summary>


https://user-images.githubusercontent.com/28596569/235618837-dc102bae-c5df-44ed-8c2e-590905e0f0b4.mp4


https://user-images.githubusercontent.com/28596569/235618840-787e37ad-5607-463a-ad66-4d35c30ecd67.mp4


https://user-images.githubusercontent.com/28596569/235618844-f00648bf-0a87-4f70-abc1-141657a406de.mp4



</details>
<details>
  <summary>ENG + TAI</summary>

https://user-images.githubusercontent.com/28596569/235614026-06d42b3f-a655-4f62-b3b9-7847ed3a8033.mp4


https://user-images.githubusercontent.com/28596569/235615245-762c5e14-d943-41c9-bc44-39f9d007258a.mp4


https://user-images.githubusercontent.com/28596569/235615248-dd71d7e0-a885-446b-a03e-94bd1704b610.mp4

</details>
<details>
  <summary>TAI + TAI</summary>


https://user-images.githubusercontent.com/28596569/235619051-8357d566-6f09-455d-92bf-d965f7b40acc.mp4


https://user-images.githubusercontent.com/28596569/235619055-047a8e81-e08b-4fde-b144-ca5201e8ea39.mp4


https://user-images.githubusercontent.com/28596569/235619057-ebc1b28f-b2d5-490a-a8db-2407c7079f08.mp4

</details>
</details>

<details> 
	<summary><b> Model with corpus tt - clean</b></summary>

<details>
  <summary>ENG + ENG</summary>


https://user-images.githubusercontent.com/28596569/236253178-1e2c7c16-aac1-4eb7-a4c1-61381ac2bbd1.mp4


https://user-images.githubusercontent.com/28596569/236253184-9f335327-6ede-4887-890b-8b01cdf73bd8.mp4


https://user-images.githubusercontent.com/28596569/236253185-8b8f6785-998e-42f4-af24-e5ec62df72bd.mp4

</details>
<details>
  <summary>ENG + TAI</summary>


https://user-images.githubusercontent.com/28596569/236253258-9237a771-bdca-463b-937b-fb157222ab11.mp4


https://user-images.githubusercontent.com/28596569/236253261-ae896146-c378-4bf4-b4df-8a8645c86d1c.mp4


https://user-images.githubusercontent.com/28596569/236253263-a0ad6b56-cf28-4ec3-a62c-5457f65ca6e5.mp4

</details>
<details>
  <summary>TAI + TAI</summary>


https://user-images.githubusercontent.com/28596569/236253368-952ab688-e4be-4f21-b192-a110643c8f4c.mp4


https://user-images.githubusercontent.com/28596569/236253372-70012a6a-ea1f-4d79-bcec-3a3c2f9827de.mp4


https://user-images.githubusercontent.com/28596569/236253375-16815c7f-8f38-4a42-9f62-e7910cf41f96.mp4

</details>
</details>

<details> 
	<summary><b> Model with extended corpus (ee + et + tt) - clean</b></summary>

<details>
  <summary>ENG + ENG</summary>


https://user-images.githubusercontent.com/28596569/235621410-6c5df439-71b5-457c-ba11-505758f239a7.mp4


https://user-images.githubusercontent.com/28596569/235621413-a85e0c00-28d1-4dec-912a-7023c1e12583.mp4


https://user-images.githubusercontent.com/28596569/235621415-26a74fcb-e93a-4981-9500-b52f9c0a1b14.mp4

</details>
<details>
  <summary>ENG + TAI</summary>


https://user-images.githubusercontent.com/28596569/235621285-bbdc81e2-c492-4111-aa6c-764a1484a7ef.mp4


https://user-images.githubusercontent.com/28596569/235621288-afb263bf-8fc5-4258-90da-1c6578c76900.mp4


https://user-images.githubusercontent.com/28596569/235621291-e3b96cf1-a3d0-4f89-afb5-2e1d67d7d8d9.mp4

</details>
<details>
  <summary>TAI + TAI</summary>


https://user-images.githubusercontent.com/28596569/235621854-196ebd8f-1789-47ac-9003-9186b3c93e63.mp4


https://user-images.githubusercontent.com/28596569/235621856-0231ec63-27a9-4a70-b613-20c7b988ebad.mp4


https://user-images.githubusercontent.com/28596569/235621859-84446477-c039-4792-867a-4f4d9b41398e.mp4

</details>
</details>

<details> 
	<summary><b> Model with corpus ee - noisy</b></summary>

<details>
  <summary>ENG + ENG</summary>


https://user-images.githubusercontent.com/28596569/236253490-8748f870-b7ae-4c7a-97dc-4438e7b28406.mp4


https://user-images.githubusercontent.com/28596569/236253494-ac48666a-da3e-477c-a7b1-687e1b1002e1.mp4


https://user-images.githubusercontent.com/28596569/236253498-bd6c02dc-f013-4206-b529-618c3689e47f.mp4

</details>
<details>
  <summary>ENG + TAI</summary>


https://user-images.githubusercontent.com/28596569/236253551-3dde66c3-dc69-461b-8506-384e22dae874.mp4


https://user-images.githubusercontent.com/28596569/236253554-79b245e6-37ed-4feb-9e1a-b1adab45d550.mp4


https://user-images.githubusercontent.com/28596569/236253556-2d89cf17-9dff-471a-8651-09d2fcb7e441.mp4

</details>
<details>
  <summary>TAI + TAI</summary>


https://user-images.githubusercontent.com/28596569/236253608-5c781c6c-682b-4590-90f4-9fbadf83f70d.mp4


https://user-images.githubusercontent.com/28596569/236253618-5fb99665-f1d8-45f1-81b7-d595d71707a5.mp4


https://user-images.githubusercontent.com/28596569/236253620-96b3ba4e-d231-4463-aea4-b4cbe5be8ced.mp4

</details>
</details>

<details> 
	<summary><b> Model with corpus et - noisy</b></summary>

<details>
  <summary>ENG + ENG</summary>


https://user-images.githubusercontent.com/28596569/235619488-6152a2b5-ec08-42d9-ac2b-e0f1a8907c3a.mp4


https://user-images.githubusercontent.com/28596569/235619491-2296b373-9f53-4700-ac94-71e53eb9743e.mp4


https://user-images.githubusercontent.com/28596569/235619494-30be71c8-2756-4a2b-b6d8-05882f43ff99.mp4

</details>
<details>
  <summary>ENG + TAI</summary>


https://user-images.githubusercontent.com/28596569/235619344-dbf52591-116c-4c93-8250-3c9b076d8e8a.mp4


https://user-images.githubusercontent.com/28596569/235619347-16bf5c40-b556-4b8b-a8b3-7ccc627e1783.mp4


https://user-images.githubusercontent.com/28596569/235619351-f2d4df2d-d9ba-414c-be86-4d9e8b589d8a.mp4

</details>
<details>
  <summary>TAI + TAI</summary>


https://user-images.githubusercontent.com/28596569/235619675-a9e411a1-7d13-4e0c-a853-457f5ede8ff5.mp4


https://user-images.githubusercontent.com/28596569/235619677-9bad99e7-f20d-4f12-a2b2-36ec8a128fd0.mp4


https://user-images.githubusercontent.com/28596569/235619679-783512ec-d4cb-49e9-8fa2-35d11e891a5f.mp4

</details>
</details>

<details> 
	<summary><b> Model with corpus tt - noisy</b></summary>

<details>
  <summary>ENG + ENG</summary>


https://user-images.githubusercontent.com/28596569/236253709-c68a57da-7025-4634-8bb3-68a044a3cf85.mp4


https://user-images.githubusercontent.com/28596569/236253714-d4db24af-a1ed-4146-9ec4-7f1996d46fa5.mp4


https://user-images.githubusercontent.com/28596569/236253718-eab06312-e322-41d4-8c30-4a06898c3bb8.mp4

</details>
<details>
  <summary>ENG + TAI</summary>


https://user-images.githubusercontent.com/28596569/236253773-b5fe872b-140a-4121-94c5-4753c9f2d276.mp4


https://user-images.githubusercontent.com/28596569/236253777-78ded6c9-1371-4ff6-bffa-b2bfe623e84e.mp4


https://user-images.githubusercontent.com/28596569/236253780-7e77ef83-92a9-4dd3-bf32-e64e2be9fdfd.mp4

</details>
<details>
  <summary>TAI + TAI</summary>


https://user-images.githubusercontent.com/28596569/236253819-95c1f295-8507-4ddb-a404-3e4137898980.mp4


https://user-images.githubusercontent.com/28596569/236253825-ad06482a-f8c1-497c-80bc-a10994af14d1.mp4


https://user-images.githubusercontent.com/28596569/236253826-1a53d6d2-8a7b-40b6-b5d2-f869fc1752a8.mp4

</details>
</details>

<details> 
	<summary><b> Model with extended corpus (ee + et + tt) - noisy</b></summary>

<details>
  <summary>ENG + ENG</summary>


https://user-images.githubusercontent.com/28596569/235620304-19193a93-9f42-4de2-8c3b-b9cb0bd1b5a5.mp4


https://user-images.githubusercontent.com/28596569/235620307-94b765cb-a375-4284-a9f5-7755ecdc3a76.mp4


https://user-images.githubusercontent.com/28596569/235620309-6cb5f273-9310-4513-8cde-dcadc009ce65.mp4

</details>
<details>
  <summary>ENG + TAI</summary>


https://user-images.githubusercontent.com/28596569/235620105-87b1c79f-69e3-4306-b962-7b1c09d96aec.mp4


https://user-images.githubusercontent.com/28596569/235620110-96050c95-bf12-4f3c-80c8-580ab582f49e.mp4


https://user-images.githubusercontent.com/28596569/235620115-5704c36a-4e57-481c-9e16-c967df15b374.mp4

</details>
<details>
  <summary>TAI + TAI</summary>


https://user-images.githubusercontent.com/28596569/235621074-f5750828-8749-44db-807d-c3bde3666e04.mp4


https://user-images.githubusercontent.com/28596569/235621079-ac8046e0-00a1-48e2-ad5a-aa8253b32a9a.mp4


https://user-images.githubusercontent.com/28596569/235621077-70716e1d-b8ec-4e88-896b-64dc0d383838.mp4

</details>
</details>

## RESULTS
![image](https://user-images.githubusercontent.com/28596569/234551926-0b495e1d-8e81-4ffb-a7d9-c6a92fc55477.png)

# METACENTRUM - GUIDE
### INTRO
https://wiki.metacentrum.cz/wiki/Pruvodce_pro_zacatecniky<br/>
https://docs.metacentrum.cz/basics/jobs/<br/>

<b>LOGIN VIA PUTTY</b><br/>
https://wiki.metacentrum.cz/wiki/Usage_of_PuTTY<br/>
https://docs.metacentrum.cz/advanced/run-graphical/#connect-with-putty-in-windows<br/>
martin_matousek@<t/>alfrid.metacentrum.cz

<b>Setting up WinSCP</b><br/>
https://wiki.metacentrum.cz/wiki/Usage_of_WinSCP<br/>
https://docs.metacentrum.cz/data/data-within/#scp<br/>
data transfer

<b>INTERACTIVE JOB</b> - conda requirements installation, settings, scripts testing, ...<br/>
`qsub -I -l select=1:ncpus=1:mem=128gb:scratch_ssd=128gb:ngpus=1:gpu_cap=cuda80 -q gpu -l walltime=1:00:00`

## CONDA SETTINGS
### Required modules
`module load conda-modules`<br/>
`module load gcc-8.3.0`<br/>
`module add conda-modules-py37`

### Creating environment (with prefix - only working solution for me)
`cd $SCRATCHDIR`<br/>
`conda create --prefix=/storage/plzen1/home/martin_matousek/conda/dp_plzen python=3.8`<br/>
`conda activate /storage/plzen1/home/martin_matousek/conda/dp_plzen`

##### Adding environment to PATH
`export PATH=/storage/plzen1/home/martin_matousek/conda/dp_plzen/bin:$PATH`

##### This setting helped to save pkgs, envs to disks with free quotas
`conda config --prepend pkgs_dirs /storage/plzen1/home/martin_matousek/.conda/pkgs`<br/>
`conda config --prepend envs_dirs /storage/plzen1/home/martin_matousek/.conda/envs`


## Requirements installation
##### Specific versions, otherwise it didn't work
`conda install pytorch=1.10.0 torchvision torchaudio=0.10.0 cudatoolkit=11.1 -c pytorch -c conda-forge -y`<br/>
`conda install pytorch-lightning -c conda-forge`<br/><br/>
`TMPDIR=/storage/plzen1/home/martin_matousek/cache_dir/ pip install asteroid --cache-dir=/storage/plzen1/home/martin_matousek/cache_dir/`<br/>
`TMPDIR=/storage/plzen1/home/martin_matousek/cache_dir/ pip install setuptools==59.5.0 --cache-dir=/storage/plzen1/home/martin_matousek/cache_dir/`<br/>
`TMPDIR=/storage/plzen1/home/martin_matousek/cache_dir/ pip install librosa --cache-dir=/storage/plzen1/home/martin_matousek/cache_dir/`

##### CUDA check
`python -c 'import torch; print(torch.cuda.is_available())'`<br/><br/>
v python3.8/site-packages/pytorch-lightning/loops/training_epoch_loop.py:350
added metric=0, because it was broken otherwise<br/>
`call._call_lightning_module_hook(
                    trainer,
                    "lr_scheduler_step",
                    config.scheduler,
                    monitor_val,
					metric=0,
                )`

## MISC
Change line separators to unix style LF in all scripts (not needed for python files)

#### tar files
IN GIT BASH<br/>
`tar -cvzf convtasnet.tar "convtasnet"`

## JOB START UP
job settings are directly in script files<br/>
https://wiki.metacentrum.cz/wiki/About_scheduling_system#qsub_options<br/>
https://docs.metacentrum.cz/basics/concepts/#resources<br/>
`qsub data/run_conv.sh`<br/>
`qsub data/run_conv_long.sh`<br/>
...

<b>TROUBLESHOOTING</b><br/>
https://wiki.metacentrum.cz/wiki/FAQ/Grid_computing<br/>
https://docs.metacentrum.cz/basics/concepts/<br/>
https://docs.metacentrum.cz/troubleshooting/faqs/

<b>Job time extending</b><br/>
Př. `qextend 14518449.meta-pbs.metacentrum.cz 24:00:00`
